CREATE TABLE OFICINAS (
OFICINA INT PRIMARY KEY,
CIUDAD VARCHAR(15),
REGION VARCHAR(10),
DIR INT,
OBJETIVO FLOAT,
VENTAS FLOAT NOT NULL
)

CREATE TABLE REPVENTAS (
NUM_EMPL INT NOT NULL,
NAME VARCHAR(15) NOT NULL,
EDAD INT,
OFICINA_REP INT,
TITULO VARCHAR(10),
CONTRATO DATE NOT NULL,
DIRECTOR INT,
CUOTA FLOAT,
VENTAS FLOAT NOT NULL,
FOREIGN KEY (OFICINA_REP) REFERENCES OFICINAS(OFICINA)
)

ALTER TABLE OFICINAS
DROP COLUMN DIR

ALTER TABLE OFICINAS
ADD COLUMN DIR INT;

ALTER TABLE REPVENTAS
ADD COLUMN NUM_EMPL INT;

ALTER TABLE REPVENTAS
ADD CONSTRAINT pk_numempl PRIMARY KEY (NUM_EMPL);

ALTER TABLE OFICINAS
ADD CONSTRAINT FK_OFICINAS_DIR
FOREIGN KEY (DIR) REFERENCES REPVENTAS(NUM_EMPL);

CREATE TABLE PRODUCTOS(
ID_FAB CHAR(3) NOT NULL,
ID_PRODUCTO CHAR(5) NOT NULL,
DESCRIPCION VARCHAR(20) NOT NULL,
PRECIO FLOAT NOT NULL,
EXISTENCIAS INT NOT NULL,
PRIMARY KEY (ID_FAB, ID_PRODUCTO))

CREATE TABLE CLIENTES (
NUM_CLIE INT NOT NULL,
EMPRESA VARCHAR(20) NOT NULL,
REP_CLIE INT,
LIMITE_CREDITO FLOAT,
PRIMARY KEY (NUM_CLIE))

ALTER TABLE CLIENTES
ADD CONSTRAINT fk_clientes
FOREIGN KEY (REP_CLIE) REFERENCES REPVENTAS(NUM_EMPL)

CREATE TABLE PEDIDOS(
NUM_PEDIDO INT NOT NULL,
FECHA_PEDIDO DATE NOT NULL,
CLIE INT NOT NULL,
REP INT,
FAB CHAR(3) NOT NULL,
PRODUCTO CHAR(5) NOT NULL,
CANT INT NOT NULL,
IMPORTE FLOAT NOT NULL,
PRIMARY KEY (NUM_PEDIDO),
FOREIGN KEY (CLIE) REFERENCES CLIENTES(NUM_CLIE),
FOREIGN KEY (REP) REFERENCES REPVENTAS(NUM_EMPL),
FOREIGN KEY (FAB, PRODUCTO) REFERENCES PRODUCTOS(ID_FAB, ID_PRODUCTO))

